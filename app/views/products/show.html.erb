<!--- 商品情報 -->
<div class="container top-space">
    <hr class="my-4">
    <div class="row padding">
      <div class="col-lg-5 col-lg-offset-1">
        <img src="https://www.pakutaso.com/shared/img/thumb/00_PP59_PP_TP_V.jpg" class="img-size">
      </div>
      <div class="col-lg-6">
        <h2><%= @product.name %></h2>
        <p><%= "アーティスト名: #{@product.artist.name}" %></p>
        <ul class="cp_tag01">
          <li><a href="#"><%= "#{@product.categorie.name}" %></a></li>
        <p class="price"><%= "¥ #{@product.price.to_s(:delimited)} 税込" %></p>
        </ul>
        <div class="sale-status">
        <p class="btn-border">販売中</p>
        </div>
      </div>
      <hr class="my-4">
  </div>

  <div class="container">
    <div class="icon-field">
      <%= form_for @cart_item, url: product_cart_items_path(@product) do |f| %>
        <%= f.label :"数量" %>
        <%= f.select :quantity, [1,2,3,4,5,6,7,8,9,10], :selected => 1 %>
        <%= f.submit 'カートに入れる', class: "btn btn-block btn-info" %>
      <% end %>
<!--  非同期通信のためにレンダーでここは部分テンプレート追加します。詳細はfavorites/_favorite.html.erbを参照 -->
      <%= render "favorites/favorite", product: @product %>
    </div>
  </div>

  <div class="container">
      <hr class="my-4">
      <div class="product-release">
        <h4>商品の情報</h4>
        <p><%= "発売日  #{@product.release_date}" %></p>
        <p><%= "レーベル名: #{@product.company.name}" %></p>
      </div>
      <hr class="my-4">
      <div class="product-description">
        <h4>商品説明</h4>
        <p><%= @product.description %></p>
      </div>
      <hr class="my-3">
  </div>
<div class="container">
  <h4><%= "構成数:#{@product.discs.size}枚組" %></h4>
  <br>
  <p>曲名</p>
  <div class="disc-info">
    <div class="disc1">
    <% @discs.each do |disc| %>
      <p><%= "Disc#{disc.sequence}" %></p>
      <% songs = disc.songs.all.order(sequence: 'ASC') %>
      <% songs.each do |song| %>
      <p><%= "#{song.sequence}.#{song.name}" %></p>
      <% end %>
    <% end %>
    </div>
  </div>

  <!--- レビュー一覧 -->
  <div class="container">
    <div class="review">
      <% @reviews.each do |r| %>
    <table class = "table table-striped">
      <tr>
        <th>評価</th>
        <th>商品名</th>
        <th>作成日時</th>
        <th>タイトル</th>
        <th>本文</th>
      </tr>

      <tr>
          <td><%= r.rating %>
          <div id="star-rate-<%= r.id %>"></div>
            <script>
            $('#star-rate-<%= r.id %>').raty({
              size: 36,
              starOff:  '<%= asset_path('star-off.png') %>',
              starOn : '<%= asset_path('star-on.png') %>',
              starHalf: '<%= asset_path('star-half.png') %>',
              half: true,
              readOnly: true,
              score: <%= r.rating %>,
            });
            </script>
          </td>
          <td><%= @product.name %></td>
          <td><%= r.created_at %></td>
          <td><%= r.title %></td>
          <td><%= r.body %></td>
        </tr>
      </table>
      <% end %>
    </div>
  <script>
  $('#star').raty({
    size     : 36,
    starOff:  '<%= asset_path('star-off.png') %>',
    starOn : '<%= asset_path('star-on.png') %>',
    starHalf: '<%= asset_path('star-half.png') %>',
    scoreName: 'review[rating]',
    half: true,
  });
  </script>
    <h3>タイトル</h3>
    <%= f.text_field :title %>
    <h3>本文</h3>
    <%= f.text_area :body %>


  <!--- レビュー投稿 -->
  <div class="container">
  <%= form_for [@product, @review] do |f| %>
    <%= render 'share/error_messages', object: f.object %>
      <!-- ここから星評価つけるための処理 -->
      <div class="form-group row" id="star">
        <%= f.label :rating,'評価 ', class:'col-md-3 col-form-label' %>
        <%= f.hidden_field :rating, id: :review_star %>
      </div>
    <script>
    $('#star').raty({
      size     : 36,
      starOff:  '<%= asset_path('star-off.png') %>',
      starOn : '<%= asset_path('star-on.png') %>',
      starHalf: '<%= asset_path('star-half.png') %>',
      scoreName: 'review[rating]',
      half: true,
    });
    </script>
    <!-- ここまでが星評価つけるための処理 -->
      <h3>タイトル</h3>
      <%= f.text_field :title %>
      <h3>本文</h3>
      <%= f.text_area :body %>
      <%= f.submit '投稿する' %>
    <% end %>
  </div>
</div>
